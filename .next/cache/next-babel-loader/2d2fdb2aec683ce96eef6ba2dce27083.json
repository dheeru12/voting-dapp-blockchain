{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport web3 from '../web3';\nimport { Card, Button, Icon } from 'semantic-ui-react';\nimport voting from '../Voting';\nimport Layout from '../components/Layout';\nimport { Link } from '../routes';\n\nclass votingComponent extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      disabled: false,\n      successMessage: \"\"\n    });\n\n    _defineProperty(this, \"pickWinner\", async event => {\n      event.preventDefault();\n      const accounts = await web3.eth.getAccounts();\n      const index = await voting.methods.pickWinner().call({\n        from: accounts[0]\n      });\n      this.setState({\n        successMessage: \"The winner of the current voting results is: Candidate no-\" + index + \"  ,Please redploy the contract to create a new voting session\",\n        disabled: true\n      });\n    });\n  }\n\n  static async getInitialProps() {\n    const candidates = await voting.methods.returnNames().call();\n    const manager = await voting.methods.manager().call();\n    return {\n      candidates: candidates,\n      manager: manager\n    };\n  }\n\n  async componentDidMount() {\n    const accounts = await web3.eth.getAccounts();\n\n    if (accounts[0] != this.props.manager) {\n      this.setState({\n        disabled: true\n      });\n    }\n  }\n\n  renderCandidates() {\n    let candidatecount = 0;\n    const items = this.props.candidates.map(address => {\n      return {\n        header: address,\n        description: __jsx(Link, {\n          route: `candidates/${candidatecount}`,\n          disabled: true\n        }, __jsx(\"a\", null, \"view Candidate\")),\n        meta: \"candidate no:\" + candidatecount++,\n        fluid: true\n      };\n    });\n    return items;\n  }\n\n  render() {\n    return __jsx(Layout, null, __jsx(\"h4\", null, \"Candidates participating\"), __jsx(Button, {\n      floated: \"right\",\n      content: \"create candidate\",\n      icon: \"add circle\",\n      disabled: this.state.disabled,\n      primary: true,\n      href: \"/candidates/new\"\n    }), __jsx(Button, {\n      animated: true,\n      disabled: this.state.disabled,\n      floated: \"right\",\n      positive: true,\n      onClick: this.pickWinner\n    }, __jsx(Button.Content, {\n      visible: true\n    }, __jsx(Icon, {\n      name: \"hand point right\"\n    }), \"pick Winner!!\"), __jsx(Button.Content, {\n      hidden: true\n    }, __jsx(Icon, {\n      name: \"arrow right\"\n    }))), __jsx(Card.Group, {\n      items: this.renderCandidates()\n    }), __jsx(\"h4\", {\n      style: {\n        color: \"green\"\n      }\n    }, this.state.successMessage));\n  }\n\n}\n\nexport default votingComponent;","map":{"version":3,"sources":["/home/dheeru12/projects/voting/pages/index.js"],"names":["React","Component","web3","Card","Button","Icon","voting","Layout","Link","votingComponent","disabled","successMessage","event","preventDefault","accounts","eth","getAccounts","index","methods","pickWinner","call","from","setState","getInitialProps","candidates","returnNames","manager","componentDidMount","props","renderCandidates","candidatecount","items","map","address","header","description","meta","fluid","render","state","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport web3 from '../web3';\nimport {Card, Button , Icon} from 'semantic-ui-react';\nimport voting from '../Voting';\nimport Layout from '../components/Layout'\nimport {Link} from '../routes';\nclass votingComponent extends Component{\n    state={\n        disabled:false,\n        successMessage:\"\"\n    }\n    static async getInitialProps(){\n        const candidates=await voting.methods.returnNames().call();\n        const manager=await voting.methods.manager().call();\n        return {candidates:candidates,manager:manager}\n    }\n    async componentDidMount(){\n        const accounts=await web3.eth.getAccounts();\n        if (accounts[0]!=this.props.manager){\n            this.setState({disabled:true});\n        }\n    }\n    pickWinner= async (event)=>{\n        event.preventDefault();\n        const accounts=await web3.eth.getAccounts();\n        const index=await voting.methods.pickWinner().call({from:accounts[0]});\n        this.setState({successMessage:\"The winner of the current voting results is: Candidate no-\"+index+\"  ,Please redploy the contract to create a new voting session\",disabled:true});\n\n    }\n    renderCandidates(){\n        let candidatecount=0\n        const items=this.props.candidates.map(address=>{\n            return {\n                header: address,\n                description:(\n                    <Link route={`candidates/${candidatecount}`} disabled>\n                        <a>view Candidate</a>\n                    </Link>\n                ),\n                meta:\"candidate no:\"+(candidatecount++),\n                fluid:true\n            };\n        });\n\n        return items;\n    }\n    render(){\n        return (\n            <Layout>\n                <h4>Candidates participating</h4>\n                <Button floated=\"right\" content=\"create candidate\" icon=\"add circle\" disabled={this.state.disabled} primary href='/candidates/new'></Button>\n                <Button animated disabled={this.state.disabled} floated=\"right\" positive onClick={this.pickWinner}>\n                    <Button.Content visible>\n                        <Icon name='hand point right' />\n                        pick Winner!!\n                    </Button.Content>\n                    <Button.Content hidden>\n                        <Icon name='arrow right' />\n                    </Button.Content>\n                </Button>\n                <Card.Group items={this.renderCandidates()} />\n                <h4 style={{color:\"green\"}}>\n                    {this.state.successMessage}\n                </h4>\n            </Layout>\n        );\n    }\n}\n\nexport default votingComponent;"]},"metadata":{},"sourceType":"module"}